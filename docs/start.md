# Принцип обработки запросов


1. Вызов команды инстанса основанного из метакласса `ApplicationMeta` и контекста `Context`
2. Запуск команды `execute` с передачей параметров. `self.context.execute(<params>)`
3. Передача управления в текущую стратегию, основанную на `BaseStrategy` в метод `execute` с передачей всех параметров
4. Запускается инстанс `WsgiServer` методом `server.execute(*args, **kwargs)` с установленным транспортным протоколом. По умолчанию `WsgiTransport`
5. Вызывается метод `execute` выбранной транспортной реализации, которая формирует ответ на запрос и отвечает за его доставку обратно.


## WsgiTransport

1. После запуска транспортной реализации через метод `WsgiTransport.execute` вызывается класс `RequestMaker` 
2. Класс `RequestMaker` формирует объект `Request` исходя из заголовков, которые направлены в исходном запросе
3. Затем вызывается обработчик объекта `WsgiServer` и в зависимости от типа запроса объект `Request` передается в соответсвующий обработчик
4. Происходит получения текущего роутер, который соответствует текущему запросу
5. Проверяется являться ли тип запроса, запросом на редирект, и если да происходит перенаправления
6. Иначе вызывается обработчик роутера, который возвращает тело будущего ответа
7. На основании этого ответа формируется объект `BaseResponse`
8. Объект `BaseResponse` передается в дополнительный обработчик роутера `modify_response` (который может быть переопределен) 
для модификации ответа под требования роутера
9. Формируются заголовки ответа и сам ответ в виде объекта `BaseResponse` передается в текущий транспортный объект в метод `make_response`
10. Текущий транспортный объект, уже согласно реализации протокола WSGI направляет ответ пользователю, сделавшего запрос

**Важно:** В случае ошибки на каком либо шаге, информация об ошибке направляется в метод `send_error` объекта `WsgiServer`, 
который в роутере ошибок может отрисовать ошибку в браузере направив ее в транспортный объект через метод `make_response`
